<div class="page-header">
    <h1>历史投注订单</h1>
    <div class="page-searchbox">
        <form action="log.html" method="post">
            <input type="text" name="ID" class="txt w120" placeholder="投注订单" />
            <input type="text" name="User" class="txt w120" placeholder="用户" />
            <select name="Type" class="txt" data-bind-action="admin/lottery/gamelist" data-bind-type="ajax" data-bind-callback="select"><option value="">所有彩种</option></select>
            <input type="text" name="Index" class="txt w120" placeholder="期号" />
            <input type="date" name="StartAt" class="txt" placeholder="投注时间（开始）" />
            <input type="date" name="EndAt" class="txt" placeholder="投注时间（结束）" />
            <select name="Status" class="txt" data-enum-name="BW.Common.Lottery.LotteryOrder+OrderStatus" data-enum-none="所有状态"></select>
            <input name="MinMoney" type="number" class="txt w80" placeholder="投注大于" />
            <input name="MaxMoney" type="number" class="txt w80" placeholder="投注小于" />
            <input name="MinReward" type="number" class="txt w80" placeholder="中奖大于" />
            <input name="MaxReward" type="number" class="txt w80" placeholder="中奖小于" />
            <label for="bet-log-istest">
                <input type="checkbox" name="NoTest" value="1" id="bet-log-istest" data-type="switch" />
                不含测试号
            </label>
            <input type="submit" value="查找" class="am-btn am-btn-success am-round am-text-xs" />
            <input type="reset" value="重置" class="am-btn am-btn-default am-round am-text-xs" />
        </form>
    </div>
</div>
<div class="page-table">
    <table class="list" data-bind-action="/admin/lottery/bethistory" data-bind-type="list" data-bind-load="search,pagesplit" data-bind-callback="list,count,lottery-history-status">
        <thead>
            <tr>
                <th>投注编号</th>
                <th>用户</th>
                <th>彩种/彩期</th>
                <th>玩法</th>
                <th>投注时间</th>
                <th>投注内容</th>
                <th>倍数</th>
                <th>模式</th>
                <th>注数/金额</th>
                <th>中奖/状态</th>
            </tr>
        </thead>
        <tbody data-list-element="true">
            <tr>
                <td><a href="javascript:" class="am-btn am-btn-secondary am-round am-text-xs" data-diag-name="betinfo" data-diag-data="ID=${ID}&history=1" data-diag-title="${Game}[${Index}] 编号：${ID}" data-diag-type="control" data-diag-src="controls/betinfo.html" data-diag-mask="true" data-diag-drag="true" data-diag-width="800" data-diag-height="600">${ID}</a></td>
                <td><a href="javascript:" class="diag-user" data-userid="${UserID}">${UserName}</a></td>
                <td><p>${Game}</p><p>${Index}</p></td>
                <td>${Player}</td>
                <td>${CreateAt}</td>
                <td><textarea class="txt" readonly="readonly" data-id="${ID}">${Number}</textarea></td>
                <td>${Times}</td>
                <td>${Mode:mode-show}</td>
                <td>
                    <p>${Bet}注</p>
                    <p class="am-text-danger">${Money:money}元</p>
                </td>
                <td>
                    <label data-status="${Status}" data-reward="${Reward}">${Status}</label>
                </td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td>
                    <input type="button" class="am-btn am-btn-danger am-text-xs am-round" value="提交撤单" data-action="revoke" />
                </td>
                <td colspan="7"></td>
                <td><label class="am-text-danger">${data.Money:money}</label>元</td>
                <td><label class="am-text-success">${data.Reward:money}</label>元</td>
            </tr>
        </tfoot>
    </table>
</div>

<script type="text/javascript">
    BW.callback["lottery-history-status"] = function (result) {
        var t = this;
        t.dom.element.getElements("[data-status]").each(function (item) {
            var reward = item.get("data-reward").toFloat();
            var status = item.get("data-status");
            if (reward > 0) {
                item.set("html", "<span class=\"am-text-success\">+" + htmlFunction["money"](reward) + "</span>" + (status == "撤单" ? "(撤单)" : ""));
            } else {
                item.set("html", "<span class=\"am-text-xs\">" + status + "</span>");
            }
        });
    };

</script>