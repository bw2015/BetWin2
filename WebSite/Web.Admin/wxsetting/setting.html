<div class="page-header">
    <h1>公共号设置</h1>
</div>

<div class="page-table">
    <form action="setting.html" method="post" data-bind-action="admin/wechat/savesetting" data-bind-type="ajax" data-bind-callback="form-tip" data-bind-form-tip="form-refser" data-bind-refser="wechat-setting-info">
        <table class="post" data-bind-action="admin/wechat/getsetting" data-bind-type="ajax" data-bind-callback="form-fill" id="wechat-setting-info">
            <tr>
                <th>公共号名称：</th>
                <td>
                    <input type="text" class="txt am-form-field" name="Name" required="required" />
                </td>
            </tr>
            <tr>
                <th>头像：</th>
                <td>
                    <p class="am-padding-bottom"><input type="image" name="FaceShow" class="cover" value="" /></p>
                    <input type="file" class="txt am-form-field" name="Face" />
                    <span class="desc">140px×140px</span>
                </td>
            </tr>
            <tr>
                <td colspan="2" class="am-text-center">
                    ================= 微信公众号对接参数 ===============
                </td>
            </tr>
            <tr>
                <th>AppId：</th>
                <td>
                    <input type="text" name="Setting.AppId" class="txt am-form-field" />
                </td>
            </tr>
            <tr>
                <th>AppSecret：</th>
                <td>
                    <input type="text" name="Setting.AppSecret" class="txt am-form-field" />
                </td>
            </tr>
            <tr>
                <th>微信域名：</th>
                <td>
                    <input type="text" name="Setting.Domain" class="txt am-form-field" />
                    <span class="desc">需带上http或者https开头</span>
                    <a href="javascript:" class="am-btn am-btn-primary am-text-xs am-round" data-bind-action="admin/wechat/getloginurl" data-bind-type="ajax" data-bind-callback="wechat-qrcode,form-tip" data-bind-stop="true" data-bind-event="click">测试登录</a>
                </td>
            </tr>
            <tr>
                <th></th>
                <td>
                    <input type="submit" value="保存" class="am-btn am-btn-success " />
                </td>
            </tr>
        </table>
    </form>
</div>

<script type="text/javascript">
    BW.callback["wechat-qrcode"] = function (result) {
        var t = this;
        console.log(escape(result.info.Url).toQRCode());
    };
</script>